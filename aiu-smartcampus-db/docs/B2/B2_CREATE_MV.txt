CREATE MATERIALIZED VIEW aiu_timeseries.mv_sensor_readings_hourly TO aiu_timeseries.sensor_readings_hourly\n(\n    `sensor_id` UInt32,\n    `room_id` UInt32,\n    `sensor_type` LowCardinality(String),\n    `hour` DateTime(\'UTC\'),\n    `avg_state` AggregateFunction(avg, Float64),\n    `min_state` AggregateFunction(min, Float64),\n    `max_state` AggregateFunction(max, Float64),\n    `cnt_state` AggregateFunction(count)\n)\nAS SELECT\n    sensor_id,\n    room_id,\n    sensor_type,\n    toStartOfHour(ts) AS hour,\n    avgState(value) AS avg_state,\n    minState(value) AS min_state,\n    maxState(value) AS max_state,\n    countState() AS cnt_state\nFROM aiu_timeseries.sensor_readings_raw\nGROUP BY\n    sensor_id,\n    room_id,\n    sensor_type,\n    hour
